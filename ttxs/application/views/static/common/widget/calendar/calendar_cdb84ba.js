define("common:widget/calendar/calendar.js",function(t,e){var n=t("common:widget/lib/jquery.js"),i=function(t){this.init(t)};i.prototype={dateMap:{1:31,2:28,3:31,4:30,5:31,6:30,7:31,8:31,9:30,10:31,11:30,12:31},declare:function(t){var e=new Date;if(this.year=t.b_year?t.b_year:e.getFullYear(),this.month=t.b_month?t.b_month:e.getMonth()+1,this.date=null,t.date&&0!=t.date){var n=t.date.split("-");this.year=parseInt(n[0],10),this.month=parseInt(n[1],10),this.date=parseInt(n[2],10)}this.attrDate="data-date"},init:function(t){this.declare(t),this.getDom(),this.initSelectDate(),this.selectYearEvent(),this.selectMonthEvent(),this.selectDateEvent(),this.showEvent(),this.hideEvent()},hideEvent:function(){var t=this,e=!1;this.selectWarp.on("mouseenter",function(){e=!0}).on("mouseleave",function(){e=!1}),this.calendarValue.on("blur",function(){e||t.selectWarp.hide()})},getDate:function(){return this.year&&this.month&&this.date?this.year+"-"+this.month+"-"+this.date:!1},showEvent:function(){var t=this;this.calendarValue.on("focus",function(){t.selectWarp.show()})},selectDateEvent:function(){var t=this;this.selectDateWarp.delegate("li","click",function(){var e=n(this).attr(t.attrDate);t.date=e,t.selectWarp.hide(),t.calendarValue.val(t.year+"-"+t.month+"-"+e)})},selectMonthEvent:function(){var t=this;this.monthValue.on("blur",function(){var e=n(this),i=parseInt(e.val(),10);i>0&&13>i?(t.month=i,t.initSelectDate()):e.val(t.month),n(window).unbind("keydown")}).on("focus",function(){var t=n(this);t.val(""),n(window).on("keydown",function(e){13===e.keyCode&&t.blur()})}),this.preMonthBtn.unbind().click(function(){return 1===t.month?!1:(t.month--,void t.initSelectDate())}),this.nextMonthBtn.unbind().click(function(){return 12==t.month?!1:(t.month++,void t.initSelectDate())})},selectYearEvent:function(){var t=this;this.yearValue.on("blur",function(){var e=n(this),i=parseInt(e.val(),10);i>1900&&2100>i?(t.year=i,t.initSelectDate()):e.val(t.year),n(window).unbind("keydown")}).on("focus",function(){var t=n(this);t.val(""),n(window).on("keydown",function(e){13===e.keyCode&&t.blur()})}),this.nextYeadtBtn.unbind().click(function(){t.year++,t.initSelectDate()}),this.preYearBtn.unbind().click(function(){t.year--,t.initSelectDate()})},getDateCount:function(){var t,e=this.year%4;return t=2==this.month?0==e?29:28:this.dateMap[this.month]},initSelectDate:function(){var t=new Date(this.year+"/"+this.month+"/1").getDay(),e=this.getDateCount(),n="",i=new Date,a=i.getFullYear(),h=i.getMonth()+1,o=i.getDate();this.yearValue.val(this.year),this.monthValue.val(this.month);for(var s=0;t>s;s++)n+="<li></li>";for(var s=0;e>s;s++)n+=a===this.year&&h===this.month&&o===s+1?'<li class="active-date" '+this.attrDate+'= "'+(s+1)+'"">'+(s+1)+"</li>":"<li "+this.attrDate+'= "'+(s+1)+'"">'+(s+1)+"</li>";this.selectDateWarp.html(n)},getDom:function(){this.container=n(".calendar-warp"),this.calendarValue=this.container.find(".calendar-value"),this.selectWarp=this.container.find(".calendar-select-warp"),this.preYearBtn=this.container.find(".pre-year-btn"),this.nextYeadtBtn=this.container.find(".next-year-btn"),this.yearValue=this.container.find(".year-value"),this.preMonthBtn=this.container.find(".pre-month-btn"),this.nextMonthBtn=this.container.find(".next-month-btn"),this.monthValue=this.container.find(".month-value"),this.selectDateWarp=this.container.find(".date-select")}},e.calendar=i});