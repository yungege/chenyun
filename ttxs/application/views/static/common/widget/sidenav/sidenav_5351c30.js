define("common:widget/sidenav/sidenav.js",function(t,i){var n=t("common:widget/lib/jquery.js"),e=t("common:widget/code/code.js"),o=t("common:widget/dialog/dialog.js"),s={tpl:['<div class="feedback-dialog">','<div class="title">',"<h1>用户反馈</h1>",'<span class="feedback-close"></span>',"</div>",'<div class="context">','<div class="notice">',"请您输入要反馈的内容，最少12个字","</div>","<h2>您要反馈的问题：</h2>",'<textarea class="feedback-content" placeholder="最多输入200字"></textarea>','<div class="btn-box">','<button class="submit">提交</button>','<button class="cancel">取消</button>',"</div>","</div>","</div>"].join(""),declare:function(){this.toolsShow=!1,this.dialog=null,this.timer=null},init:function(){var t=this;this.declare(),this.getDom(),this.parsePosition(),n(window).on("resize",function(){t.parsePosition()}),this.scrollEvent(),this.topEvent(),this.feedbackEvent()},feedbackEvent:function(){var t=this;this.feedbackBtn.unbind().click(function(){return t.dialog=new o.dialog({width:600,height:300,tpl:t.tpl,close:".feedback-close"}),t.getFeedbackDom(),t.cancelFeedback(),t.submitEvent(),!1})},submitEvent:function(){var t=this;this.content.on("focus",function(){t.notice.removeClass("show")}),this.submitBtn.unbind().click(function(){return t.content.val().length<12?(t.notice.html("请您输入要反馈的内容，最少12个字").addClass("show"),!1):void n.ajax({url:"/home/submit/feedback",type:"post",data:{content:t.content.val()},success:function(i){0===i.status.code?(t.notice.html("你的反馈我们已经收到，1s后将自动退出").addClass("success"),t.timer=setTimeout(function(){clearTimeout(t.timer),t.dialog.removeDialog()},1e3)):t.notice.html(e.code[i.status.code]).addClass("show")}})})},cancelFeedback:function(){var t=this;this.cancelBtn.unbind().click(function(){t.dialog.removeDialog()})},getFeedbackDom:function(){this.warp=n(".feedback-dialog"),this.content=this.warp.find(".feedback-content"),this.notice=this.warp.find(".notice"),this.submitBtn=this.warp.find(".submit"),this.cancelBtn=this.warp.find(".cancel")},topEvent:function(){this.gotopBtn.unbind().click(function(){return n("html, body").stop().animate({scrollTop:0}),!1})},scrollEvent:function(){if(!this.toolsShow)return!1;var t=this,i=0;n(window).on("scroll",function(){i=parseInt(n(window).scrollTop(),10),0===i&&t.container.is(":visible")?t.container.fadeOut():t.container.is(":visible")||t.container.fadeIn()})},parsePosition:function(){var t=parseInt(n(window).width(),10),i=(t-1300)/2-62;i>0&&(this.toolsShow=!0,this.container.css("right",i))},getDom:function(){this.container=n(".side-nav"),this.feedbackBtn=n(".feedback"),this.gotopBtn=this.container.find(".gotop")}};i.sidenav=s});