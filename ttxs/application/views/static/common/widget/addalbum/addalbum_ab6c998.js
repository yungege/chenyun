define("common:widget/addalbum/addalbum.js",function(t,i){var e=t("common:widget/lib/jquery.js"),n=t("common:widget/dialog/dialog.js"),a=t("common:widget/alert/alert.js"),s=t("common:widget/code/code.js"),c=function(t){this.settings={callback:""},this.settings=this.merge(this.settings,t),this.init()};c.prototype={tpl:['<div class="addalbum">','<div class="title">',"<h1>创建专辑</h1>",'<span class="addalum-close"></span>',"</div>",'<div class="context">','<div class="notice">',"你输入的内容有错","</div>","<h2>专辑名称</h2>",'<input type="text" placeholder="最多输入20字" class="album-name">',"<h2>描述（选填）</h2>",'<textarea class="album-summary" placeholder="最多输入100字"></textarea>','<div class="radio">','<input class="agree" checked=true type="radio">',"<i>公开</i>","所有人都可以查看此专辑","</div>",'<div class="radio">','<input class="disagree" type="radio">',"<i>私有</i>","只有您自己可以查看此专辑","</div>",'<div class="btn-box">','<button class="create">创建</button>','<button class="cancel">取消</button>',"</div>","</div>","</div>"].join(""),merge:function(t,i){for(var e in t)void 0!=i[e]&&(t[e]=i[e]);return t},declare:function(){this.dialog=null,this.noticeShowClass="show",this.noticeSuccessClass="success",this.openStatus=1},init:function(){this.declare(),this.createDialog(),this.getDom(),this.cancelEvent(),this.openChoiceEvent(),this.nameEvent(),this.createEvent()},createSuccess:function(){var t=this;this.notice.html("创建成功，1秒后自动退出").addClass(this.noticeSuccessClass);setTimeout(function(){t.dialog.removeDialog(),"function"==typeof t.settings.callback&&t.settings.callback.call(this)},1e3)},createEvent:function(){var t=this;this.createBtn.unbind().click(function(){return t.validata()?void e.ajax({url:"/home/submit/addalbum",type:"post",data:{name:t.name.val(),summary:t.summary.val(),is_open:t.openStatus},success:function(i){0===i.status.code?t.createSuccess():new a.alert({title:s.code[i.status.code],type:"warning",autoHide:!0})}}):!1})},nameEvent:function(){var t=this;this.name.on("blur",function(){t.validata()}).on("focus",function(){t.notice.removeClass(t.noticeShowClass)})},openChoiceEvent:function(){var t=this;this.open.unbind().click(function(){t.unopen.attr("checked",!1),t.openStatus=1}),this.unopen.unbind().click(function(){t.open.attr("checked",!1),t.openStatus=0})},validata:function(){return!this.name.val()||this.name.val().length>20?(this.notice.html("专辑名称不能为空并小于20字").addClass(this.noticeShowClass),!1):/^([\u4E00-\uFA29]|[\uE7C7-\uE7F3]|[\w])*$/.test(this.name.val())?this.summary.val().length>100?(this.notice.html("描述最多输入100字").addClass(this.noticeShowClass),!1):!0:(this.notice.html("专辑名称不能包含特殊符号").addClass(this.noticeShowClass),!1)},cancelEvent:function(){var t=this;this.cancelBtn.unbind().click(function(){t.dialog.removeDialog()})},getDom:function(){this.container=e(".addalbum"),this.notice=this.container.find(".notice"),this.name=this.container.find(".album-name"),this.summary=this.container.find(".album-summary"),this.open=this.container.find(".agree"),this.unopen=this.container.find(".disagree"),this.createBtn=this.container.find(".create"),this.cancelBtn=this.container.find(".cancel")},createDialog:function(){this.dialog=new n.dialog({width:465,height:468,tpl:this.tpl,close:".addalum-close"})}},i.addalbum=c});