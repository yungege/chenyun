define("common:widget/share/share.js",function(i,e){var t=i("common:widget/lib/jquery.js"),s=i("common:widget/dropmenu/dropmenu.js"),r=i("common:widget/dialog/dialog.js"),a=i("common:widget/qrcode/qrcode.js"),h=function(i){if(!i.picker)throw new Error("where is the picker?");return this.picker=t(i.picker),0===this.picker.length?!1:(this.picker=this.picker.length>1?this.picker.eq(0):this.picker,this.options=i,void this.init())};h.prototype={tpl:['<div class="share-warp">','<a href="" target="_blank"></a>',"<ul>",'<li class="weibo">',"<i></i>","新浪微博","</li>",'<li class="qqzone">',"<i></i>","QQ空间","</li>",'<li class="tweibo">',"<i></i>","腾讯微博","</li>",'<li class="renren">',"<i></i>","人人网","</li>",'<li class="douban">',"<i></i>","豆瓣网","</li>",'<li class="wechat">',"<i></i>","微信朋友圈","</li>","</ul>","</div>"].join(""),declare:function(){this.dialog=null,this.w=120,this.arrowH=10},init:function(){var i=this;this.declare(),this.createShareTpl(),this.getDom(),this.parsePosition(),t(window).on("resize",function(){i.parsePosition()}),this.initDropMenu(),this.shareEvent()},shareEvent:function(){var i=this;this.ele.unbind().click(function(){i.shareCase(t(this).attr("class"))})},weiboShare:function(){var i="http://service.weibo.com/share/share.php?";i+=this.parseParams("title","url","pic"),this.jumpShareApp(i)},qqzoneShare:function(){var i="http://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?";i+=this.parseParams("title","url","pics"),this.jumpShareApp(i)},tweiboShare:function(){var i="http://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?";i+=this.parseParams("title","url","pics"),this.jumpShareApp(i)},renrenShare:function(){var i="http://widget.renren.com/dialog/share?";i+=this.parseParams("title","resourceUrl","pic"),this.jumpShareApp(i)},doubanShare:function(){var i="http://www.douban.com/share/service?";i+=this.parseParams("name","href","pic"),this.jumpShareApp(i)},wechatTpl:['<div class="share-wechat-qrcode">',"<h2>分享到微信朋友圈</h2>",'<span class="qrcode-close"></span>','<div class="wechat-qrcode"></div>',"</div>"].join(""),wechatShare:function(){this.dialog=new r.dialog({width:202,height:242,tpl:this.wechatTpl,close:".qrcode-close"}),new a.qrcode({picker:t(".wechat-qrcode"),height:160,width:160,text:window.location.href})},parseParams:function(i,e,t){var s=[];return this.options.title&&s.push(i+"="+this.options.title),this.options.url&&s.push(e+"="+this.options.url),this.options.pic&&s.push(t+"="+this.options.pic),s.join("&")},jumpShareApp:function(i){this.jump.attr("href",i),this.jump.each(function(){this.click()})},shareCase:function(i){switch(i){case"weibo":this.weiboShare();break;case"qqzone":this.qqzoneShare();break;case"tweibo":this.tweiboShare();break;case"renren":this.renrenShare();break;case"douban":this.doubanShare();break;case"wechat":this.wechatShare()}},initDropMenu:function(){new s.dropmenu({picker:this.picker,showItem:this.container})},parsePosition:function(){var i=parseInt(this.picker.offset().left,10),e=parseInt(this.picker.offset().top,10),t=parseInt(this.picker.css("width"),10),s=parseInt(this.picker.css("padding-left"),10),r=parseInt(this.picker.css("padding-right"),10),a=parseInt(this.picker.css("height"),10),h=this.arrowH+e+a,n=i-(this.w-t-s-r)/2;this.container.css({top:h,left:n})},getDom:function(){this.container=t(".share-warp"),this.jump=this.container.find("a"),this.ele=this.container.find("li")},createShareTpl:function(){t("body").append(this.tpl)}},e.share=h});